<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Genaver</title>

    <link rel="stylesheet" href="reveal/dist/reset.css">
    <link rel="stylesheet" href="reveal/dist/reveal.css">
    <link rel="stylesheet" href="reveal/dist/theme/black.css" id="theme">
    <link rel="stylesheet" href="genaver-presentation.css">

  </head>
  <body>
    <div class="reveal">
      <div class="slides">

        <section>
          <h1>Genaver!</h1>
          <h3>por Dave Aronson</h3>
          <br>
          <h5>
            T.Rex-2023@Codosaur.us<br>
            twitter.com/DaveAronson<br>
            linkedin.com/in/DaveAronson<br>
            github.com/CodosaurusLLC/genaver
          </h5>
          <!--
            NOTE TO SELF: aiming for 25 minutes of content;
            currently have about 22, perfect for half-hour slot w/ Q&A.
          -->
        </section>

        <section>
          <h1>Genaver!</h1>
          <h3>por Dave Aronson</h3>
          <br>
          <h5>
            T.Rex-2023@Codosaur.us<br>
            twitter.com/DaveAronson<br>
            linkedin.com/in/DaveAronson<br>
            github.com/CodosaurusLLC/genaver
          </h5>
          <aside class="notes">
            Ol&aacute;, S&atilde;o Paulo!&nbsp;
            Meu nome &eacute; Dave Aronson,
            sou o T. Rex de Codosaurus,
            e voei aqui no meu pterod&aacute;tilo de estima&ccedil;&atilde;o
            para vos ensinar sobre
            a minha gambiarra
            que eu chamo de
            GENAVER!

            <br><br>

            Geralmente, neste ponto de uma apresenta&ccedil;&atilde;o,
            eu digo, "Mas, vou faz&ecirc;-lo em ingl&ecirc;s",
            e depois
            "Mainly because you've just heard
            about half the whatever-language I speak".&nbsp;
            Mas neste caso, n&atilde;o seria a verdade!&nbsp;
            Minha esposa e eu estamos aprendendo o portugu&ecirc;s
            h&aacute; cerca de dois anos e meio,
            porque estamos pensando em aposentar-nos em . . .
            desculpem, n&atilde;o Brasil mas Portugal.&nbsp;
            Mas, bastante com a nossa vida pessoal,
            voltamos ao assunto.

            <br><br>

            O nome Genaver n&atilde;o &eacute; uma refer&ecirc;ncia ao
            nome de menina . . .
          </aside>
        </section>

        <section>
          <div class="vctring" style="font-size: 4em">867-5309</div>
          <img src="images/nope-scope.png" class="centered" style="z-index: 1">
          <aside class="notes">
            . . . Jennifer, nem . . .
          </aside>
        </section>

        <section>
          <img src="images/guinevere-and-lancelot.jpg" height="100%">
          <span class="slide-caption">Image: https://commons.wikimedia.org/wiki/File:Emil_Teschendorff_-_Queen_Guinevere_bidding_farewell_to_Sir_Lancelot.jpg</span>
          <aside class="notes">
            . . . &agrave; Rainha Guinevere, nem . . .
          </aside>
        </section>

        <section>
          <img src="images/jenever.jpg">
          <span class="slide-caption">Image: https://commons.wikimedia.org/wiki/File:King_%26_Barnes_Jenever_vaten.JPG</span>
          <aside class="notes">
            . . . a bebida, em verdade pronunciada je-NEE-ver,
            como descobri h&aacute; alguns meses.&nbsp;
            Genaver &eacute; uma abrevia&ccedil;&atilde;o
            para uma frase em ingl&ecirc;s,
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div style="font-size: 3em; text-align: left">
              GEN<span style="color: #888">erate</span><br>
              A<br>
              VER<span style="color: #888">sion</span>
            </div>
          </div>
          <aside class="notes">
            . . .
            GENerate A VERsion,
            ou em portugu&ecirc;s,
            gerar uma vers&atilde;o.&nbsp;
            Mas, uma vers&atilde;o do que, e por que?&nbsp;
            Voc&ecirc;s que viram . . .
          </aside>
        </section>

        <section>
          <img src="images/gambiconf-eu-monkey.jpg" height="100%">
          <span class="slide-caption">Image: logo at https://www.facebook.com/people/GambiConf/100079650866213/</span>
          <aside class="notes">
            . . . o GambiConf do ano passado, em Lisboa, podem lembrar de . . .
          </aside>
        </section>

        <section>
          <img src="images/gambiconf-eu-dave.png" height="100%">
          <span class="slide-caption">Image: https://www.facebook.com/102543485504335/photos/a.111732384585445/169776295447720/</span>
          <aside class="notes">
            . . . mim, falando (em ingl&ecirc;s) sobre Mutation Testing,
            ou em portugu&ecirc;s, Teste de Muta&ccedil;&atilde;o.&nbsp;

            <br><br>

            N&atilde;o foi a &uacute;nica vez que
            eu fiz essa apresenta&ccedil;&atilde;o.&nbsp;
            Eu a fiz com a introdu&ccedil;&atilde;o em
            muitas linguagens humanas,
            o c&oacute;digo em muitas linguagens de programa&ccedil;&atilde;o,
            e em v&aacute;rias dura&ccedil;&otilde;es,
            de vinte minutos a setenta.

            <br><br>

            Manter uma apresenta&ccedil;&atilde;o em PowerPoint ou Keynote,
            faz um arquivo muito grande e bin&aacute;rio.&nbsp;
            Por isso, &eacute; muito dif&iacute;cil de compar&aacute;-los,
            ou de encontrar uma boa frase de uma vers&atilde;o anterior,
            para coloc&aacute;-la numa vers&atilde;o nova<!--,
            especialmente se, entre a confer&ecirc;ncia anterior e agora,
            eu fiz uma vers&atilde;o menor,
            sem essa boa frase -->.

            <br><br>

            Por estas raz&otilde;es, eu queria um jeito de manter uma . . .
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div style="border: 2px solid white; padding: 0.5em">
              <h2>Apresenta&ccedil;&atilde;o</h2>
              <small>
                ...<br>
                Introdu&ccedil;&atilde;o em Portugu&ecirc;s<br>
                Introdu&ccedil;&atilde;o em Japon&ecirc;s<br>
                Introdu&ccedil;&atilde;o em Klingon<br>
                ...<br>
                Explica&ccedil;&atilde;o Prolixa<br>
                Explica&ccedil;&atilde;o Concisa (da mesma coisa)<br>
                ...<br>
                C&oacute;digo em Elixir<br>
                C&oacute;digo em Ruby<br>
                C&oacute;digo em Befunge<br>
                ...
              </small>
            </div>
          </div>
          <aside class="notes">
            . . . "vers&atilde;o prim&aacute;ria",
            com a introdu&ccedil;&atilde;o e o c&oacute;digo em
            todas as linguagens que eu usei,
            e com todas as descri&ccedil;&otilde;es,
            todos os peda&ccedil;os que n&atilde;o mudam, etc.&nbsp;
            Ent&atilde;o, eu poderia gerar uma vers&atilde;o com, por exemplo,
            a introdu&ccedil;&atilde;o em japon&ecirc;s, o codigo em Ruby,
            e cabendo em quarenta e cinco minutos,
            ou com a introdu&ccedil;&atilde;o sueca, o codigo em Elixir
            (uma linguagem criado por um brasileiro!),
            e cabendo em trinta minutos,
            sem precisar editar o arquivo . . . muito.&nbsp;
            Idealmente, eu poderia fazer uma nova vers&atilde;o por
            adicionar as novas se&ccedil;&otilde;es nas novas linguagens,
            e passar novos argumentos
            para um programa para escolher essas linguagens,
            e as explica&ccedil;&otilde;es longas, curtas, ou m&eacute;dias.

            <br><br>

            Eu sabia que o primeiro passo seria
            p&ocirc;r a apresenta&ccedil;&atilde;o num
            formato textual (al&eacute;m das imagens).&nbsp;
            Felizmente, h&aacute; muitos sistemas de
            fazer apresenta&ccedil;&otilde;es en HTML ou Markdown.&nbsp;
            O mais famoso &eacute; RevealJS, qual eu escolhei,
            e qual estou usando para esta apresenta&ccedil;&atilde;o agora.

            <br><br>

            Depois disso, pensei que precisaria . . .
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code" style="font-size: 0.6em">
              <code>
                &lt;dave-special-tag linguagem-humana="portugu&ecirc;s"&gt;<br>
                &nbsp;&nbsp;Isto &eacute; em portugu&ecirc;s<br>
                &lt;/dave-special-tag&gt;<br>
                <br>
                &lt;dave-special-tag linguagem-humana="igpay-atinlay"&gt;<br>
                &nbsp;&nbsp;Isthay isay inay igpay atinlay<br>
                &lt;/dave-special-tag&gt;<br>
                <br>
                &lt;dave-special-tag linguagem-de-programa&ccedil;&atilde;o="elixir"&gt;<br>
                &nbsp;&nbsp;IO.puts("Ol&aacute, mundo!")<br>
                &lt;/dave-special-tag&gt;<br>
                <br>
                &lt;dave-special-tag linguagem-de-programa&ccedil;&atilde;o="c"&gt;<br>
                &nbsp;&nbsp;printf("Ol&aacute, mundo!\n")<br>
                &lt;/dave-special-tag&gt;<br>
              </code>
            </div>
          </div>
          <aside class="notes">
            . . . marcar o HTML com tags especiais,
            e escrever um programa para
            aceitar argumentos que expressam meus desejos, analisar essa HTML,
            e . . .
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div style="font-size: 1.5em">
              <p>Com argumentos de escolher<br>
              portugu&ecirc;s e Elixir:</p>
              <div class="code">
                <code>
                  Isto &eacute; em portugu&ecirc;s<br>
                  IO.puts("Ol&aacute, mundo!")
                </code>
              </div>
            </div>
          </div>
          <aside class="notes">
            . . . fazer um novo arquivo de acordo com meus desejos.&nbsp;
            Eu me esforcei um pouco em pensar nisso, e procrastinei.&nbsp;
            Meses mais tarde, tenho a ideia de fazer
            um abuso grosseiro do . . .

          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code" style="font-size: 0.9em; width: fit-content">
              <code>
                #define ENGLISH   1<br>
                #define FRANCAIS  2<br>
                #define PORTUGU&Ecirc;S 3<br>
                #define WANTED_LANGUAGE PORTUGU&Ecirc;S<br>
                /* ... */<br>
                #if WANTED_LANGUAGE == ENGLISH<br>
                &nbsp;&nbsp;&nbsp;&nbsp;Hello, world!<br>
                #elif WANTED_LANGUAGE == FRANCAIS<br>
                &nbsp;&nbsp;&nbsp;&nbsp;Bonjour, monde!<br>
                #elif WANTED_LANGUAGE == PORTUGU&Ecirc;S<br>
                &nbsp;&nbsp;&nbsp;&nbsp;Ol&aacute;, mundo!<br>
                #endif<br>
              </code>
            </div>
          </div>
          <aside class="notes">
            . . . pr&eacute;-processador da linguagem C,
            uma gambiarra verdadeira,
            usando principalmente as diretivas "define" e "if",
            e talvez . . .
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code" style="font-size: 1.2em; width: fit-content">
              <code>
                #include "introduction"<br>
                #include "problem_description"<br>
                #include "proposed_solution"<br>
                #include "tech_description"<br>
                #include "pros_and_cons"<br>
                #include "conclusion"
              </code>
            </div>
          </div>
          <aside class="notes">
            . . . "include",
            para organizar os peda&ccedil;os de
            uma apresenta&ccedil;&atilde;o.&nbsp;
            Isso daria muito menos trabalho!&nbsp;
            Mas, de novo, eu procrastinei,
            porque n&atilde;o gostei muito dessa solu&ccedil;&atilde;o.&nbsp;
            Ela me pareceu um pouco ... suja demais.

            <br><br>

            Semanas mais tarde, eu discuti a ideia do programa
            com um outro palestrante.&nbsp;
            Ele recomendou que eu usasse
            uma biblioteca em Python para processamento de texto,
            com que ele teve muito sucesso.&nbsp;
            Ele come&ccedil;ou a usar isso porque ele queria
            se afastar do processamento de texto em JavaScript.
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div style="line-height: 4em">
              <span style="font-size: 4em">💡</span>
              <br>
              <span style="font-size: 6em">👨🏽</span>
            </div>
          </div>
          <aside class="notes">
            DING!&nbsp; Ou talvez, D'OH!

            <br><br>

            Finalmente, eu tive meu momento de l&acirc;mpada!&nbsp;
            O texto j&aacute; foi em HTML, e mudar a apar&ecirc;ncia de HTML
            &eacute; exatamente o papel de JavaScript!&nbsp;
            Melhor ainda, &eacute; uma das tarefas
            (na minha opini&atilde;o, das <i>poucas</i> tarefas)
            para as quais
            o JavaScript &eacute; verdadeiramente bom!&nbsp;
            Eu s&oacute; tinha que mudar minha ideia
            de copiar os peda&ccedil;os bons, a esconder os ruins!

            <br><br>

            Ent&atilde;o, eu fiz um pequeno Proof of Concept,
            ou em portugu&ecirc;s, Prova de Conceito.&nbsp;

            <br><br>

            J&aacute; comecei escrever
            minhas novas apresenta&ccedil;&otilde;es em . . .
          </aside>
        </section>

        <section>
          <img src="images/revealjs.jpg">
          <aside class="notes">
            . . .  RevealJS,
            e ia fazer uma, sobre Algor&iacute;tmos Gen&eacute;ticos,
            nas semanas que vem.&nbsp;
            Eu ia faz&ecirc;-la
            uma vez em vinte e cinco minutos
            com a introdu&ccedil;ao em espanhol,
            uma vez em trinta e cinco minutos
            com a introdu&ccedil;ao em holand&ecirc;s,
            e uma vez em cinquenta minutos com
            a introdu&ccedil;ao em noruegu&ecirc;s.&nbsp;
            Eu j&aacute; tive as tr&ecirc;s vers&otilde;es separadas,
            e as combinei,
            numa "vers&atilde;o prim&aacute;ria"
            para testar minha gambiarra.&nbsp;
            E . . .
          </aside>
        </section>

        <section>
          <img src="images/thumb-up-emoji-clipart-lg.png">
          <span class="slide-caption">Image: https://creazilla.com/nodes/60301-thumb-up-emoji-clipart</span>
          <aside class="notes">
            . . . ela deu certo!&nbsp;
            Eu pudesse passar argumentos diferentes ao JavaScript,
            para escolher a introdu&ccedil;&atilde;o,
            e esconder peda&ccedil;os que precisam tempo demais,
            &agrave;s vezes substituindo peda&ccedil;os menores.

            <br><br>

            N&atilde;o ainda confiei nela, suficiente para us&aacute;-la nas confer&ecirc;ncias,
            mas continuei a adicionar recursos,
            como passar os argumentos na URL,
            substituindo pelos valores passado direto ao JavaScript.
            Ent&atilde;o, pudesse usar exatamente o mesmo HTML para
            muitas vers&otilde;es de uma apresenta&ccedil;&atilde;o,
            e configur&aacute;-lo com argumentos na URL.

            <br><br>

            Mas, como ela funciona?
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div style="font-size: 0.25em">
              <code>
                <pre>
function generate_version(args=[]) {
  const url_params = Array.from(new URLSearchParams(window.location.search));
  var   specs;

  specs = parse_specs(args, {});
  specs = parse_specs(fix_url_params(url_params), specs);

  for (const key of Object.keys(specs)) {
    var op, val;
    [op, val] = specs[key];
    var data_key = `data-${key}`;
    switch(op) {
      case '=':  filter_str_same(data_key, val); break;
      case '!=': filter_str_diff(data_key, spec.val, false); break;
      case '@':  filter_num_at(data_key, val); break;
      case '&lt;':  filter_num(data_key, val, is_lt); break;
      case '&lt;=': filter_num(data_key, val, is_le); break;
      case '&gt;':  filter_num(data_key, val, is_gt); break;
      case '&gt;=': filter_num(data_key, val, is_ge); break;
    }
  }
}

const SPEC_REGEX = /^([a-zA-Z0-9-_]+)\s*([<=>!@]+)\s*(.+)$/;

function parse_specs(args, so_far) {
  for (var arg of args) {
    var key, op, val;
    [key, op, val] = SPEC_REGEX.exec(arg).slice(1, 4);
    so_far[key] = [op, val];
  }
  return so_far;
}

function fix_url_params(url_params) {
  const fixed_params = [];
  for (var [key, val] of url_params) {
    fixed_params.push(val ? `${key}=${val}` : key);
  }
  return fixed_params;
}

function filter_num_at(key, value) {
  filter_num(`${key}-min`, value, is_le);
  filter_num(`${key}-max`, value, is_ge);
}

function is_ge(x, limit) { return x >= limit }
function is_gt(x, limit) { return x >  limit }
function is_le(x, limit) { return x <= limit }
function is_lt(x, limit) { return x <  limit }

function filter_num(key, value, comp_fn) {
  const limit = parseInt(value);
  const all  = document.querySelectorAll(`[${key}]`);
  for (elt of all) {
    if (! comp_fn(parseInt(elt.getAttribute(key)), limit)) {
      elt.style.display = 'none';
    }
  }
}

function filter_str_diff(key, value) {
  const all =
    document.querySelectorAll(`[${key}="${value}"]`);
  for (elt of all) elt.style.display = 'none';
}

function filter_str_same(key, value) {
  const all = document.querySelectorAll(`[${key}]`);
  for (elt of all) {
    if (elt.getAttribute(key) != value) {
      elt.style.display = 'none';
    }
  }
}
                </pre>
              </code>
            </div>
          </div>
          <aside class="notes">
            Aqui es&aacute; <i>o c&oacute;digo enteiro</i> de Genaver.&nbsp;
            N&atilde;o, n&atilde;o espero que
            voc&ecirc;s leiam tudo isso!&nbsp;
            Vamos ver pe&ccedil;a por pe&ccedil;a.&nbsp;
            Inicialmente, . . .
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code" style="font-size: 0.8em">
              <code>
                <pre>
function generate_version(args=[]) {<span style="color: gray">
  const url_params = Array.from(new URLSearchParams(window.location.search));
  </span>var   specs;

  specs = parse_specs(args, {});<span style="color: gray">
  specs = parse_specs(fix_url_params(url_params), specs);

  for (const key of Object.keys(specs)) {
    var op, val;
    [op, val] = specs[key];
    var data_key = `data-${key}`;
    switch(op) {
      case '=':  filter_str_same(data_key, val); break;
      case '!=': filter_str_diff(data_key, spec.val, false); break;
      case '@':  filter_num_at(data_key, val); break;
      case '&lt;':  filter_num(data_key, val, is_lt); break;
      case '&lt;=': filter_num(data_key, val, is_le); break;
      case '&gt;':  filter_num(data_key, val, is_gt); break;
      case '&gt;=': filter_num(data_key, val, is_ge); break;
    }
  }
}</span>
                </pre>
              </code>
            </div>
          </div>
          <aside class="notes">
            . . . ela aceita s&oacute; um argumento,
            opcional, passado ao JavaScript,
            que &eacute; uma lista de filtros,
            padrão para uma lista vazia.&nbsp;
            Cada filtro &eacute; um string.&nbsp;
            A lista &eacute; analisada por . . .
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code" style="font-size: 1.1em">
              <code>
                <pre>
const SPEC_REGEX = /^([a-zA-Z0-9-_]+)\s*([<=>!@]+)\s*(.+)$/;

function parse_specs(args, so_far) {
  for (var arg of args) {
    var key, op, val;
    [key, op, val] = SPEC_REGEX.exec(arg).slice(1, 4);
    so_far[key] = [op, val];
  }
  return so_far;
}
                </pre>
              </code>
            </div>
          </div>
          <aside class="notes">
            . . . esse c&oacute;digo.&nbsp;
            Ele usa um regex para dividir a string
            em uma chave, uma comparação, e um valor.&nbsp;

            <br><br>

            As chaves representam escolhas como
            linguagem humana, linguagem de programa&ccedil;&atilde;o,
            tempo minimo ou maximo de qual uma coisa precisa,
            ou qualquer outra coisa que querem escolher.

            <br><br>

            As compara&ccedil;&otilde;es sāo . . .
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code">
              <code>
                <pre>
<span style="color: gray">switch(op) {
  case </span>'='<span style="color: gray">:  filter_str_same(data_key, val); break;
  case </span>'!='<span style="color: gray">: filter_str_diff(data_key, spec.val, false); break;
  case </span>'@'<span style="color: gray">:  filter_num_at(data_key, val); break;
  case </span>'&lt;'<span style="color: gray">:  filter_num(data_key, val, is_lt); break;
  case </span>'&lt;='<span style="color: gray">: filter_num(data_key, val, is_le); break;
  case </span>'&gt;'<span style="color: gray">:  filter_num(data_key, val, is_gt); break;
  case </span>'&gt;='<span style="color: gray">: filter_num(data_key, val, is_ge); break;
}</span>
                </pre>
              </code>
            </div>
          </div>
          <aside class="notes">
            . . . igual, n&atilde;o igual,
            uma coisa especial que explicarei mais tarde,
            menos, menos ou igual, maior, e maior ou igual.&nbsp;
            As compara&ccedil;&otilde;es de ordem s&atilde;o usadas
            s&oacute; para os valores num&eacute;ricos,
            e igual ou n&atilde;o-igual s&atilde;o para
            os n&uacute;meros e os strings.&nbsp;
            Por isso, voc&ecirc;s podem usar um filtro como
            "linguagem &eacute; portugu&ecirc;s"
            (ou specificamente portugu&ecirc;s-brasileiro)
            mas n&atilde;o "linguagem &eacute; maior que portugu&ecirc;s".

            <br><br>

            Cada chave fica uma chave num dicion&aacute;rio,
            onde o valor &eacute; uma lista,
            com a compara&ccedil;&atilde;o, e o valor, do filtro.&nbsp;
            Por examplo, . . .
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code" style="font-size: 1.1em">
              <code>["ling = pt", "tempo-min &lt;= 30"]</code><br><br>
              <center>becomes</center><br>
              <code>
                { "ling"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: ["=", &nbsp;"pt"],<br>
                &nbsp;&nbsp;"tempo-min": ["&lt;=", 30&nbsp;&nbsp;] }
              </code>
            </div>
          </div>
          <aside class="notes">
            . . . a lista dos filtros
            linguagem &eacute; portugu&ecirc;s
            e
            tempo-min &eacute; menos ou igual a trinta,
            se torna ao dicion&aacute;rio
            com as chaves linguagem e tempo-min,
            e as valores como isto.&nbsp;
            (Observam que o trinta &eacute; um numero, sem aspas.)

            <br><br>

            Ent&atilde;o, . . .
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code" style="font-size: 1.1em">
              <code>
                <pre>
<span style="color: gray">specs = parse_specs(args, {});</span>
specs = parse_specs(fix_url_params(url_params), specs);
                </pre>
              </code>
            </div>
          </div>
          <aside class="notes">
            . . . ela faz a mesma coisa com
            os arguments passados na URL.&nbsp;
            Mas, um sinal de igual
            pode quebrar um filtro na URL!&nbsp;
            Por isso, Genaver tem . . .
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code" style="font-size: 1.3em">
              <code>
                <pre>
function fix_url_params(url_params) {
  const fixed_params = [];
  for (var [key, val] of url_params) {
    fixed_params.push(val ? `${key}=${val}` : key);
  }
  return fixed_params;
}
                </pre>
              </code>
            </div>
          </div>
          <aside class="notes">
            . . . uma fun&ccedil;&atilde;o que
            remonta os filtros quebrados, assim.&nbsp;
            Ela leva os URL-parameters, como pars de chave e valor.&nbsp;
            Se tem um valor,
            junta-lo com a chave e um sinal de igual.&nbsp;
            Se n&atilde;o, usa s&oacute; a chave.&nbsp;
            Depois disto, temos uma lista de filtros,
            num formato exatamente igual &agrave; lista passado no JavaScript,
            e . . .
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code" style="font-size: 1.2em">
              <code>
                <pre>
<span style="color: gray">specs = parse_specs(args, {});</span>
specs = parse_specs(fix_url_params(url_params), specs);
                </pre>
              </code>
            </div>
          </div>
          <aside class="notes">
            . . . a enviamos para a mesma fun&ccedil;&atilde;o.&nbsp;
            Mas, em vez de enviar tamb&eacute;m um dicion&aacute;rio vazia,
            enviamos o dicion&aacute;rio
            dos filtros passado no JavaScript.&nbsp;
            Ent&atilde;o, se passarmos na URL
            uma compara&ccedil;&atilde;o ou um valor diferente
            para a mesma chave que no JavaScript,
            o que passamos na URL
            &eacute; substitu&iacute;do
            pelo que passamos no JavaScript.&nbsp;
            Ent&atilde;o, os filtros no JavaScript
            podem ser usados como padr&otilde;es,
            para serem substitu&iacute;dos
            pelos filtros na URL.&nbsp;
            Por exemplo . . .
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code" style="font-size: 1.2em">
              <code>generate_version(["ling=es"]);</code>
            </div>
          </div>
          <aside class="notes">
            se temos a chamada para Genaver assim,
            especificando a linguagem espanhol,
            mas a URL e . . .
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code" style="font-size: 2em">
              <code>talk.html?ling=pt</code>
            </div>
          </div>
          <aside class="notes">
            assim, especificando a linguagem <i>portugu&ecirc;s</i>,
            vamos ver a apresenta&ccedil;&atilde;o em portugu&ecirc;s.

            <br><br>

            Agora que Genaver tem todos os argumentos, ela . . .
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code">
              <code>
                <pre>
for (const key of Object.keys(specs)) {
  var op, val;
  [op, val] = specs[key];
  var data_key = `data-${key}`;
  switch(op) {
    case '=':  filter_str_same(data_key, val); break;
    case '!=': filter_str_diff(data_key, spec.val, false); break;
    case '@':  filter_num_at(data_key, val); break;
    case '&lt;':  filter_num(data_key, val, is_lt); break;
    case '&lt;=': filter_num(data_key, val, is_le); break;
    case '&gt;':  filter_num(data_key, val, is_gt); break;
    case '&gt;=': filter_num(data_key, val, is_ge); break;
  }
}
                </pre>
              </code>
            </div>
          </div>
          <aside class="notes">
            . . .  os aplica ao documento, filtro por filtro.&nbsp;
            Para cada um, ela precede a chave com a palavra "data",
            e faz algo um pouco diferente,
            de acordo com a compara&ccedil;&atilde;o.

            <br><br>

            Para a compara&ccedil;&atilde;o de "n&atilde;o igual",
            &eacute; muito simples —
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code" style="font-size: 1.2em">
              <code>
                <pre>
function filter_str_diff(key, value) {
  const all =
    document.querySelectorAll(`[${key}="${value}"]`);
  for (elt of all) elt.style.display = 'none';
}
                </pre>
              </code>
            </div>
          </div>
          <aside class="notes">
            ela usa querySelectorAll para encontrar todos os elementos
            com esse valor para esse atributo, e os esconde.&nbsp;

            <br><br>

            Para "igual", . . .
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code" style="font-size: 1.2em">
              <code>
                <pre>
function filter_str_same(key, value) {
  const all = document.querySelectorAll(`[${key}]`);
  for (elt of all) {
    if (elt.getAttribute(key) != value) {
      elt.style.display = 'none';
    }
  }
}
                </pre>
              </code>
            </div>
          </div>
          <aside class="notes">
            . . .  &eacute; quase mesmo.&nbsp;
            Ela encontra todos os elementos com esse atributo,
            com <i>qualquer</i> valor,
            itera atrav&eacute;s deles,
            e esconde os que <i>n&atilde;o</i> tem esse valor.&nbsp;

            <br><br>

            Para as outras compara&ccedil;&otilde;es, . . .
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code" style="font-size: 1.2em">
              <code>
                <pre>
case '&lt;':  filter_num(data_key, val, is_lt); break;
case '&lt;=': filter_num(data_key, val, is_le); break;
case '&gt;':  filter_num(data_key, val, is_gt); break;
case '&gt;=': filter_num(data_key, val, is_ge); break;
                </pre>
              </code>
            </div>
          </div>
          <aside class="notes">
            . . .  &eacute; um pouco mais complexo que isso,
          porque precisa . . .
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code" style="font-size: 1.1em">
              <code>
                <pre>
function filter_num(key, value, comp_fn) {
  const limit = parseInt(value);
  const all = document.querySelectorAll(`[${key}]`);
  for (elt of all) {
    if (! comp_fn(parseInt(elt.getAttribute(key)), limit)) {
      elt.style.display = 'none';
    }
  }
}
                </pre>
              </code>
            </div>
          </div>
          <aside class="notes">
            . . . converter os atributos de strings em n&uacute;meros,
            e verificar seus rela&ccedil;&otilde;es ao argumento.&nbsp;
            Ela faz isso por encontrar todos os elementos com o atributo,
            e para cada um,
            usar uma fun&ccedil;&atilde;o de compara&ccedil;&atilde;o
            para verificar se
            a rela&ccedil;&atilde;o desejado &eacute; verdadeira,
            e se <i>n&atilde;o</i>, esconde o elemento.&nbsp;
            As . . .
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code" style="font-size: 1.4em">
              <code>
                <pre>
function is_ge(x, limit) { return x &gt;= limit }
function is_gt(x, limit) { return x &gt;  limit }
function is_le(x, limit) { return x &lt;= limit }
function is_lt(x, limit) { return x &lt;  limit }
                </pre>
              </code>
            </div>
          </div>
          <aside class="notes">
            . . .  fun&ccedil;&otilde;es de compara&ccedil;&atilde;o
            s&atilde;o muito simples.&nbsp;
            Eu poderia usar literais de fun&ccedil;&atilde;o,
            em vez de fun&ccedil;&otilde;es reais,
            mas ent&atilde;o n&atilde;o poderia
            fazer a &uacute;ltima compara&ccedil;&atilde;o
            t&atilde;o simples.&nbsp;
            A compara&ccedil;&atilde;o de arroba . . .
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code" style="font-size: 1.6em">
              <code>
                <pre>
function filter_num_at(key, value) {
  filter_num(`${key}-min`, value, is_le);
  filter_num(`${key}-max`, value, is_ge);
}
                </pre>
              </code>
            </div>
          </div>
          <aside class="notes">
            . . . &eacute; &uacute;til quando queremos mostrar os elementos,
            cujo algum atributo &eacute; maior que algo limite,
            e algum <i>outro</i> atributo &eacute; <i>menor</i>
            que <i>o mesmo limite</i>.&nbsp;
            Principalmente, eu uso isto para marcar alguns elementos com
            o m&iacute;nimo e m&aacute;ximo quantia de tempo
            para os incluir.&nbsp;
            Por exemplo, . . .
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code" style="font-size: 1.5em">
              <code>
                <pre>
&lt;p data-tempo-max="19"&gt;
&nbsp;&nbsp;Explica&ccedil;&atilde;o curta.
&lt;/p&gt;
&lt;p data-tempo-min="20" data-tempo-max="29"&gt;
&nbsp;&nbsp;Explica&ccedil;&atilde;o m&eacute;dia.
&lt;/p&gt;
&lt;p data-tempo-min="30"&gt;
&nbsp;&nbsp;Explica&ccedil;&atilde;o longa.
&lt;/p&gt;
                </pre>
              </code>
            </div>
          </div>
          <aside class="notes">
            . . . se tenho algo que eu queira dizer,
            e poderia diz&ecirc;-lo em um minuto, cinco, ou dez,
            talvez eu quereria diz&ecirc;-lo de maniera curta
            quando tenho menos que vinte minutos para falar,
            de maneira m&eacute;dia
            quando tenho vinte a vinte-nove minutos,
            e de maneira longa quando tenho trinta minutos ou mais.&nbsp;
            Se tenho quinze minutos, e uso o filtro "tempo arroba quinze", . . .
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code" style="font-size: 1.6em">
              <code>
                <pre>
function filter_num_at(key, value) {
  filter_num(`${key}-min`, value, is_le);
  filter_num(`${key}-max`, value, is_ge);
}
                </pre>
              </code>
            </div>
          </div>
          <aside class="notes">
            . . . isto faz a mesmo coisa como se eu tivesse passado
            "tempo-min &eacute; menor ou igual a quinze" e
            "tempo-max &eacute; maior ou igual a quinze".

            <br><br>

            E agora, vamos fazer uma pequena demonstra&ccedil;&atilde;o.
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code" style="font-size: 1.7em">
              <code>generate_version([]);</code>
            </div>
          </div>
          <aside class="notes">
            Aqui est&aacute; a chamada para Genaver,
            no fundo desta apresenta&ccedil;&atilde;o.&nbsp;
            Veja que n&atilde;o tem nenhum filtros.&nbsp;
            E . . .
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code">
              <code>
                &lt;p data-ling="en"&gt;<br>
                &nbsp;&nbsp;This is in English.<br>
                &lt;/p&gt;<br>
                &lt;p data-ling="fr"&gt;<br>
                &nbsp;&nbsp;Ceci est en fran&ccedil;ais.<br>
                &lt;/p&gt;<br>
                &lt;p data-ling="pt"&gt;<br>
                &nbsp;&nbsp;Isto &eacute; em portugu&ecirc;s.<br>
                &lt;/p&gt;<br>
              </code>
            </div>
          </div>
          <aside class="notes">
            . . . aqui est&aacute; o c&oacute;digo
            do pr&oacute;ximo slide.&nbsp;
            Se irmos al&iacute;,
            o que voc&ecirc;s pensam que aparecer&aacute;?&nbsp;
            Quem pensa "nada"?&nbsp;
            Levante uma m&atilde;o ou fa&ccedil;a um barulho.&nbsp;
            E quem pensa "tudo"?&nbsp;
            De novo, m&atilde;o ou barulho.&nbsp;
            Algumas outras respostas?&nbsp;
            . . .
            Vamos-l&aacute; e ver!
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div style="font-size: 2em">
              <p data-ling="en">This is in English.</p>
              <p data-ling="fr">Ceci est en fran&ccedil;ais.</p>
              <p data-ling="pt">Isto &eacute; em portugu&ecirc;s.</p>
            </div>
          </div>
          <aside class="notes">
            Vemos tudo, porque Genaver n&atilde;o funciona por
            preservar os peda&ccedil;os bons,
            mas <i>esconder</i> os <i>ruins</i>.

            <br><br>

            Vamos dar uma olhada para a URL.&nbsp;
            N&atilde;o tem nenhum argumentos l&aacute;,
            nem na chamada, ent&atilde;o,
            Genaver n&atilde;o sabe o que esconder,
            e n&atilde;o esconde nada.

            <br><br>

            Mas agora, vamos mudar a URL,
            por adicionar o argumento ling=en.&nbsp;
            Se agora n&oacute;s recarregarmos a p&aacute;gina,
            . . .
            agora vemos a vers&atilde;o em ingles.&nbsp;
            E podemos fazer a mesma coisa com franc&ecirc;s
            e portugu&ecirc;s.&nbsp;
            Podemos fazer a mesma coisa com
            linguagens de programa&ccedil;&atilde;o,
            ou qualquer outra coisa,
            por simplemente usar uma outra chave.&nbsp;
            Por exemplo . . .
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code" style="font-size: 1.2em">
              <code>
                &lt;p data-ling-prog="c"&gt;<br>
                &nbsp;&nbsp;printf("Blah.\n")<br>
                &lt;/p&gt;<br>
                &lt;p data-ling-prog="elixir"&gt;<br>
                &nbsp;&nbsp;IO.puts("Blah.")<br>
                &lt;/p&gt;<br>
                &lt;p data-ling-prog="ruby"&gt;<br>
                &nbsp;&nbsp;puts "Blah."<br>
                &lt;/p&gt;<br>
              </code>
            </div>
          </div>
          <aside class="notes">
            E aqui est&aacute; o c&oacute;digo
            do <i>pr&oacute;ximo</i> slide.&nbsp;
            Vamos-l&aacute; e ver o que aparecer&aacute;!
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code" style="font-size: 2em">
              <code>
                <p data-ling-prog="c">printf("Blah.\n")</p>
                <p data-ling-prog="elixir">IO.puts("Blah.")</p>
                <p data-ling-prog="ruby">puts "Blah."</p>
              </code>
            </div>
          </div>
          <aside class="notes">
            De novo, vemos tudo, porque
            de novo, Genaver n&atilde;o sabe o que esconder.&nbsp;
            Mas vamos mudar a URL,
            por adicionar o argumento ling-prog=c,
            e recarregamos a p&aacute;gina.&nbsp;
            Agora vemos s&oacute; a vers&atilde;o em C.&nbsp;
            E podemos fazer a mesma coisa com Elixir e Ruby.

            <br><br>

            Mas, que tal a dura&ccedil;&atilde;o?
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code">
              <code>
                &lt;p data-tempo-max="19"&gt;<br>
                &nbsp;&nbsp;Explica&ccedil;&atilde;o curta.<br>
                &lt;/p&gt;<br>
                &lt;p data-tempo-min="20"<br>
                &nbsp;&nbsp;&nbsp;data-tempo-max="29"&gt;<br>
                &nbsp;&nbsp;Explica&ccedil;&atilde;o m&eacute;dia.<br>
                &lt;/p&gt;<br>
                &lt;p data-tempo-min="30"&gt;<br>
                &nbsp;&nbsp;Explica&ccedil;&atilde;o longa.<br>
                &lt;/p&gt;
              </code>
            </div>
          </div>
          <aside class="notes">
            De novo, aqui est&aacute; o c&oacute;digo
            do pr&oacute;ximo slide.&nbsp;
            Observa que as explica&ccedil;&otilde;es
            s&atilde;o marcadas com os atributos
            "tempo-min", "tempo-max", ou talvez ambos.&nbsp;
            Queremos a explica&ccedil;&atilde;o curta
            se temos menos que vinte minutos para falar,
            a m&eacute;dia se temos de vinte a vinte-nove,
            e a longa se temos trinta ou mais.

            <br><br>

            Vamos-l&aacute; e ver o que aparece!
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div style="font-size: 2em">
              <p data-tempo-max="19">Explica&ccedil;&atilde;o curta.</p>
              <p data-tempo-min="20" data-tempo-max="29">Explica&ccedil;&atilde;o m&eacute;dia.</p>
              <p data-tempo-min="30">Explica&ccedil;&atilde;o longa.</p>
            </div>
          </div>
          <aside class="notes">
            Como antes, vemos tudo, porque
            n&atilde;o dissemos a Genaver o que esconder.&nbsp;
            Mas vamos mudar a URL de novo.&nbsp;

            <br><br>

            Podemos dizer, se temos por exemplo
            quinze minutos para falar,
            tempo-min menos ou igual a quinze,
            e tempo-max maior ou igual a quinze,
            e isso d&aacute; certo.&nbsp;
            Mas, &eacute; um pouco chato,
            precisar dar ambos o tempos
            m&iacute;nimo e m&aacute;ximo,
            quando s&atilde;o geralmente o mesmo n&uacute;mero,
            n&eacute;?&nbsp;
            Podemos dizer, em vez de desses <i>dois</i> argumentos,
            tempo <i>arroba</i> quinze,
            e Genaver interpreta isso como o min e o max, assim.&nbsp;
            E a vinte, vemos a explica&ccedil;&atilde;o m&eacute;dia,
            assim de novo com vinte-nove,
            e a trinta (ou mais),
            vemos a explica&ccedil;&atilde;o longa.

            <br><br>

            Podemos ainda usar os compara&ccedil;&otilde;es
            de menor, maior, menor ou igual, e maior ou igual,
            para outros prop&oacute;sitos,
            mas eu pessoalmente n&atilde;o tenho motivos para us&aacute;-los,
            ent&atilde;o n&atilde;o vou demonstr&aacute;-los.
          </aside>
        </section>

        <section>
          <div class="vctring">
            <div class="code" style="font-size: 1.2em">
              <code>
                <pre>
generate_version(["ling-humana = pt",
                  "ling-prog = elixir",
                  "tempo @ 30"])
                </pre>
              </code>

              <center>or</center><br>

              <code>
                <pre>
talk.html?ling-humana=pt&ling-prog=elixir&tempo@30
                </pre>
              </code>
            </div>
          </div>
          <aside class="notes">
            Agora, eu espero que voc&ecirc;s entedam como,
            com a minha gambiarra chamada Genaver,
            eu posso alcan&ccedil;ar meu objetivo,
            de manter <i>uma</i> "vers&atilde;o prim&aacute;ria"
            de uma apresenta&ccedil;&atilde;o,
            e fazer, rapidamente e facilmente,
            uma vers&atilde;o com
            uma linguagem humana,
            uma linguagem de programa&ccedil;&atilde;o,
            e uma dura&ccedil;&atilde;o (aproximada),
            de minha escolha.

            <br><br>

            E agora, . . .
          </aside>
        </section>

        <section>
          <h1>? ? ? ? ?</h1>
          <br>
          <h5>
            T.Rex-2023@Codosaur.us<br>
            twitter.com/DaveAronson<br>
            linkedin.com/in/DaveAronson<br>
            <br>
            github.com/CodosaurusLLC/genaver<br>
            SLIDE URL TBD
          </h5>
          <aside class="notes">
            . . . se h&aacute; perguntas, aceitarei-las agora,
            e se voc&ecirc;s pensarem em algo mais tarde,
            aqui est&atilde;o minhas informa&ccedil;&otilde;es de contato,
            e as URLs de Genaver e dos slides desta apresenta&ccedil;&atilde;,
            completo com um roteiro.&nbsp;
            Eu posso <i>falar</i> o portugu&ecirc;s rapido,
            mas n&atilde;o posso <i>entender</i>-lo rapido, ent&atilde;o
            se h&aacute; perguntas, eu pe&ccedil;o que voc&ecirc;s
            perguntem um pouco devagar . . . ou em ingl&ecirc;s.&nbsp;
            H&aacute; perguntas?
          </aside>
        </section>

      </div>
    </div>

    <script src="reveal/dist/reveal.js"></script>
    <script src="reveal/plugin/notes/notes.js"></script>
    <script src="reveal/plugin/markdown/markdown.js"></script>
    <script src="reveal/plugin/highlight/highlight.js"></script>
    <script src="../genaver.js"></script>
    <script>
      // More info about initialization & config:
      // - https://revealjs.com/initialization/
      // - https://revealjs.com/config/
      const width = 960;
      Reveal.initialize({
        controls: false,
        hash: true,
        history: true,
        transition: "none",
        transitionSpeed: "fast",
        width: width,
        height: width * 9 / 16,

        // Learn about plugins: https://revealjs.com/plugins/
        plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
      });
      Reveal.configure({ pdfMaxPagesPerSlide: 1, showNotes: 'separate-page' });
      generate_version([]);
    </script>
  </body>
</html>
